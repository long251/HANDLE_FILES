Lá»˜ TRÃŒNH Há»ŒC NESTJS
-------------------
NgÃ y báº¯t Ä‘áº§u: 25/02/2025
------------------------

Giai Ä‘oáº¡n 1: Náº¯m vá»¯ng cÆ¡ báº£n (1-2 tuáº§n)
1ï¸âƒ£ LÃ m quen vá»›i NestJS
âœ… CÃ i Ä‘áº·t NestJS CLI vÃ  táº¡o dá»± Ã¡n Ä‘áº§u tiÃªn.					/ xong
âœ… Hiá»ƒu vá» Module, Controller, Service â€“ 3 thÃ nh pháº§n cá»‘t lÃµi.			/ (1)
âœ… LÃ m viá»‡c vá»›i Routing & Request Handling (GET, POST, PUT, DELETE).
âœ… DÃ¹ng DTO (Data Transfer Object) Ä‘á»ƒ validate dá»¯ liá»‡u vá»›i class-validator.

ðŸ‘‰ BÃ i táº­p: Táº¡o API Ä‘Æ¡n giáº£n (/users) vá»›i CRUD cÆ¡ báº£n.

(1):
 -> NestJS lÃ  má»™t framework Modular (tá»©c lÃ  má»i thá»© Ä‘Æ°á»£c chia thÃ nh cÃ¡c module Ä‘á»™c láº­p). Ba thÃ nh pháº§n cá»‘t lÃµi trong NestJS gá»“m:
 - Module: 	quáº£n lÃ½ vÃ  gom nhÃ³m cÃ¡c thÃ nh pháº§n liÃªn quan (Controller, service, provider...)
 - controller: 	nháº­n yÃªu cáº§u (res) tá»« client vÃ  gá»i service Ä‘á»ƒ xá»­ lÃ½ logic
 - service: 	xá»­ lÃ½ logic nghiá»‡p vá»¥ vÃ  thao tÃ¡c db
=> vÃ­ dá»¥: xÃ¢y dá»±ng 1 user API:
		- GET danh sÃ¡ch user
		- POST táº¡o user má»›i
- BÆ°á»›c 1: Táº¡o Module (Quáº£n lÃ½ cÃ¡c thÃ nh pháº§n liÃªn quan)
		- Táº¡o module user báº±ng NestJS CLI:
		- nest generate module user (nest g mo user)
			 Lá»‡nh nÃ y sáº½ táº¡o file user.module.ts trong thÆ° má»¥c src/user:
				- @Module() lÃ  má»™t decorator giÃºp Ä‘á»‹nh nghÄ©a module.
				- controllers: [UserController] Ä‘Äƒng kÃ½ Controller xá»­ lÃ½ request.
				- providers: [UserService] Ä‘Äƒng kÃ½ Service Ä‘á»ƒ xá»­ lÃ½ logic.
import { Module } from '@nestjs/common';
import { UserController } from './user.controller';
import { UserService } from './user.service';

@Module({
  controllers: [UserController],
  providers: [UserService],
})
export class UserModule {}


- BÆ°á»›c 2: Táº¡o Controller (Xá»­ lÃ½ Request tá»« Client)
		- nest generate controller user (nest g co user)
			Lá»‡nh nÃ y sáº½ táº¡o file user.controller.ts:
				- @Controller('user') Ä‘á»‹nh nghÄ©a URL /user.
				- @Get() xá»­ lÃ½ request GET /user.
				- @Post() xá»­ lÃ½ request POST /user.
				- @Body() láº¥y dá»¯ liá»‡u tá»« body cá»§a request.
				- UserService Ä‘Æ°á»£c inject vÃ o Controller Ä‘á»ƒ xá»­ lÃ½ logic.
import { Controller, Get, Post, Body } from '@nestjs/common';
import { UserService } from './user.service';

@Controller('user')
export class UserController {
  constructor(private readonly userService: UserService) {}

  @Get()
  getUsers() {
    return this.userService.getUsers();
  }

  @Post()
  createUser(@Body() body: { name: string }) {
    return this.userService.createUser(body.name);
  }
}
=> CHI TIáº¾T:
	- @GET - xá»­ lÃ½ res GET, dÃ¹ng Ä‘á»ƒ Ä‘á»‹nh nghÄ©a 1 HTTP GET
@Get()
getUsers() {
  return this.userService.getUsers();
}
Khi client gá»i GET /user, phÆ°Æ¡ng thá»©c getUsers() sáº½ Ä‘Æ°á»£c thá»±c thi.
	- @POST - res POST, route HTTP POST
@Post()
createUser(@Body() body: { name: string }) {
  return this.userService.createUser(body.name);
}
	- @Body - res body, láº¥y data JSON tá»« res body gá»­i lÃªn



- BÆ°á»›c 3: Táº¡o Service (Xá»­ lÃ½ logic nghiá»‡p vá»¥)
		- nest generate service user (nest g s user)
			Lá»‡nh nÃ y sáº½ táº¡o file user.service.ts:
				- @Injectable() giÃºp NestJS quáº£n lÃ½ service nÃ y.
				- getUsers() tráº£ vá» danh sÃ¡ch user.
				- createUser(name) thÃªm user má»›i vÃ o danh sÃ¡ch.
import { Injectable } from '@nestjs/common';

@Injectable()
export class UserService {
  private users = [];

  getUsers() {
    return this.users;
  }

  createUser(name: string) {
    const newUser = { id: Date.now(), name };
    this.users.push(newUser);
    return newUser;
  }
}
Sá»¬A: private users: { id: number; name: string }[] = [];
NÃŠN DÃ™NG INTERFACE HOáº¶C TYPE:
export interface User {
  id: number;
  name: string;
}

@Injectable()
export class UserService {
  private users: User[] = [];

  getUsers() {
    return this.users;
  }

  createUser(name: string) {
    const newUser: User = { id: Date.now(), name };
    this.users.push(newUser);
    return newUser;
  }
}
DÃ™NG TYPE:
type User = {
  id: number;
  name: string;
};

@Injectable()
export class UserService {
  private users: User[] = [];

  getUsers() {
    return this.users;
  }

  createUser(name: string) {
    const newUser: User = { id: Date.now(), name };
    this.users.push(newUser);
    return newUser;
  }
}


- BÆ°á»›c 4: Kiá»ƒm tra API
 - cháº¡y server: npm run start
 - Má»Ÿ Postman hoáº·c cURL, gá»i API: Láº¥y danh sÃ¡ch user (GET /user): curl http://localhost:3000/user	[]
 - curl -X POST http://localhost:3000/user -H "Content-Type: application/json" -d '{"name": "John Doe"}'
{
  "id": 1708892123000,
  "name": "John Doe"
}
 - Láº¥y danh sÃ¡ch user sau khi thÃªm (GET /user) [{}]
 - 

HÃ£y thÃªm xoÃ¡ user theo ID (DELETE /user/:id). (bÃ i táº­p) @Delete()
TEST:
 - postman: http://localhost:3000/user
 - táº¡o: chuyá»ƒn POST > chá»n: body > raw > JSON; 